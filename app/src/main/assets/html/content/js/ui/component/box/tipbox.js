/*!
 * TipBox
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(t,e,i){"use strict";function o(t){if(t&&t.nodeType){for(var e=0,o=t,n=!1;o&&o.nodeType&&o!=i.body&&e<50;){if(1==o.nodeType&&"none"!=o.style.display&&o.attributes&&"tip"in o.attributes){n=!0;break}o=o.parentNode,e++}return n?o:void 0}}function n(e){if(e&&e.nodeType){for(var o=0,n=e,r=!1;n&&n.nodeType&&n!=i.body&&o<5;){if(1==n.nodeType&&t.nodeName(n,"div")&&t.inArray(t.attr(n,"id"),v)>-1){r=!0;break}n=n.parentNode,o++}return r?n:void 0}}function r(t){return f&&t.touchs&&t.touchs.length?t.touchs[0].target:t.target?t.target:t.srcElement}function a(o,n){if(o&&1==o.nodeType&&"none"!=o.style.display){var r=t.attr(o,p);r||(r="wade_tipbox-"+ ++c,t.attr(o,p,r));var a=o.getBoundingClientRect(),l={targetLeft:a.left,targetTop:a.top,targetWidth:o.offsetWidth,targetHeight:o.offsetHeight,color:n?n:""};return e[r]?t.extend(e[r],l):(t(i.body).append('<div id="'+r+'" class="c_tooltip c_tooltip-top" style="left:-99999px;top:-99999px;max-width:28.5em;display:none">\t<div id="'+r+'_content" class="content">'+t.attr(o,"tip")+"\t</div></div>"),e[r]=new b(r,l))}}if(t&&"undefined"==typeof t.TipBox){var l,d=(Object.prototype.toString,Array.prototype.push),s=Array.prototype.splice,p=(Wade.support.deleteExpando,"TipBox"+(new Date).valueOf()),c=0,f="undefined"!=typeof t.hasTouch?t.hasTouch:"ontouchstart"in e,u=f?"touchstart":"mouseover",y=13.2,g=7.2,h=1100,v=[],b=function(e,o){var n=this;n.el=e&&1==e.nodeType?e:i.getElementById(e),n.el&&n.el.nodeType&&(n.id=t.attr(n.el,"id"))&&(o&&t.isObject(o)&&t.extend(n,o),t.attr(n.el,"x-wade-uicomponent","tipbox"),n._init(),n.constructor.call(n))};b.prototype=t.extend(new t.UIComponent,{update:function(e,i){var o=this;if(i&&t.isString(i)&&(o.color=i),void 0!=e&&t.isString(e)&&o.ctEl){if(e=e.replace(/\n|\\n/gi,"<br />"),e==o.ctEl.innerHTML)return;o.ctEl.innerHTML=e,!0===o.visible&&o.adjust()}},show:function(){var e=this;!0!==e.visible&&(e.adjust(),e.el.style.zIndex=h+t.inArray(e.id,v),e.el.style.display="",e.visible=!0)},hide:function(){var t=this;t.el.style.display="none",t.visible=!1},adjust:function(){var t,e,o=this;!0!==o.visible&&(o.el.style.left="-99999px",o.el.style.top="-99999px",o.el.style.display=""),t=o.ctEl.offsetHeight,e=o.ctEl.offsetWidth,!0!==o.visible&&(o.el.style.display="none");var n=i.body.offsetHeight,r=i.body.offsetWidth,a="",l="",d=o.targetLeft+o.targetWidth/2,s=o.targetTop+o.targetHeight/2;a=s>n/3*2?"top":s<n/3?"bottom":"",l=d>r/3*2?"left":d<r/3?"right":"";var p=d,c=s;"bottom"==a?c=o.targetTop+o.targetHeight+g:"top"==a?c=o.targetTop-t-g:""==a&&(c=""==l?o.targetTop+o.targetHeight+g:o.targetTop+o.targetHeight/2-t/2),"left"==l?p=""==a?o.targetLeft-e-g:o.targetLeft+o.targetWidth/2-e+y:"right"==l?p=""==a?o.targetLeft+o.targetWidth+g:o.targetLeft+o.targetWidth/2-y:""==l&&(p=o.targetLeft+o.targetWidth/2-e/2);var f="c_tooltip";(a||l)&&(f+=" c_tooltip",f+=a?"-"+a:"",f+=l?"-"+l:""),o.color&&(f+=" c_tooltip-"+o.color),o.el.className=f,o.el.style.left=p+"px",o.el.style.top=c+"px",o.el.style.display="",o.el.className="",setTimeout("document.getElementById('"+o.id+"').className='"+f+"'",1)},destroy:function(){var e=this;e.ctEl=null,e.el=null,s.call(v,t.inArray(e.id,v),1)},_init:function(){var e=this;e.ctEl=i.getElementById(e.id+"_content"),e.visible=!1,t.inArray(e.id,v)<0&&d.call(v,e.id)}}),t(function(){f&&t(i.body).bind("longTap",function(e){var i=r(e);if(i){var n,d=o(i);d&&(n=a(d),n&&(n.update(t.attr(d,"tip")),n.show())),n&&(l=n.id)}}),t(i.body).bind(u,function(i){i.originalEvent&&(i=i.originalEvent);var d=r(i);if(d){var s;if(!f){var p=o(d);p&&(s=a(p),s&&(s.update(t.attr(p,"tip")),s.show()))}l&&e[l]&&(!s&&!n(d)||s&&s.id!=l)&&(e[l].hide(),l=null),s&&(l=s.id)}}),t(e).bind("onorientationchange"in e?"orientationchange":"resize",function(){l&&e[l]&&(e[l].hide(),l=null)})}),t.extend(b,{make:a,show:function(t,i,o){var n=a(t,o);return n&&(n.update(i,o),n.show()),l&&e[l]&&n&&n.id!=l&&(e[l].hide(),l=null),n&&(l=n.id),n}}),t.TipBox=b,e.showTipBox=b.show}}(window.Wade,window,document);