/*!
 * increasereduce component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(e,i,n){"use strict";function a(e){var n;u&&(n=i[u])&&(i.clearInterval(n.increaseReduceInterval),n.increaseReduceInterval=null),u=null}if(e&&"undefined"==typeof e.IncreaseReduce){var t=n.createElement("input"),l="oninput"in t;t=null;var u,d="undefined"!=typeof e.hasTouch?e.hasTouch:"ontouchstart"in i,r=d?"touchend":"mouseup",v=d?"touchcancel":"mouseup",s=function(i,a){var t=this;t.el=i&&1==i.nodeType?i:n.getElementById(i),t.el&&t.el.nodeType&&(t.id=e.attr(t.el,"id"))&&(a&&e.isObject(a)&&e.extend(t,a),e.attr(t.el,"x-wade-uicomponent")||e.attr(t.el,"x-wade-uicomponent","increasereduce"),t._init(),t.constructor.call(t))};s.prototype=e.extend(new e.UIComponent,{val:function(i){var n=this;return e.isNumeric(i)?(i=parseInt(i),void(void 0!=n.min&&i<n.min||void 0!=n.max&&i>n.max||(n.value=i,n.el.value=i))):void 0!=typeof n.value&&null!=n.value?""+n.value:""},getDisabled:function(){var e=this;return e.disabled},setDisabled:function(i){var n=this;n.disabled=!!i;var a=n.div.className?n.div.className:"";n.disabled?((" "+a+" ").indexOf(" e_dis ")<0&&(n.div.className=e.trim(a+" e_dis")),n.el.disabled=!0):(a=e.trim((" "+a+" ").replace(/ e_dis /gi," ")),n.div.className=a,n.el.disabled=!1)},destroy:function(){var e=this;e.div=null,e.btnReduce=null,e.btnIncrease=null,e.el=null},_init:function(){var n=this;n.div=e(n.el).parent("div.e_mix:first")[0],n.btnReduce=e(n.div).children("span.e_ico-reduce:first")[0],n.btnIncrease=e(n.div).children("span.e_ico-add:first")[0],/^[0-9]+/gi.test(n.el.value)?n.el.value=n.value=parseInt(n.el.value):n.el.value=n.value=0,n.disabled&&n.setDisabled(!0),e(n.btnReduce).tap(function(){return!n.disabled&&void n._reduce()}),e(n.btnIncrease).tap(function(){return!n.disabled&&void n._increase()}),e(n.btnReduce).longTap(function(){return!n.disabled&&void(u||n.increaseReduceInterval||(n.increaseReduceInterval=i.setInterval(function(){n._reduce()},500),u=n.id))}),e(n.btnIncrease).longTap(function(){return!n.disabled&&void(u||n.increaseReduceInterval||(n.increaseReduceInterval=i.setInterval(function(){n._increase()},500),u=n.id))}),l?e(n.el).bind("input",function(e){var i;if(this.value=(""+this.value).replace(/[^0-9]+/gi,""),""!=this.value){if(i=parseInt(this.value),void 0!=n.min&&i<n.min||void 0!=n.max&&i>n.max)return void(this.value=n.value);this.value=i}void 0!=i&&(n.value=i)}):(e(n.el).bind("keydown",function(e){return!n.disabled&&(!(e.shiftKey||e.altKey||e.ctrlKey)&&(e.keyCode>47&&e.keyCode<58||e.keyCode>95&&e.keyCode<106||8==e.keyCode||46==e.keyCode))}),e(n.el).bind("keyup",function(e){if(n.disabled)return!1;var i;if(""!=this.value){if(i=parseInt(this.value),void 0!=n.min&&i<n.min||void 0!=n.max&&i>n.max)return void(this.value=n.value);this.value=i}void 0!=i&&(n.value=i)}))},_increase:function(){var i,n=this,a=n.value;if(e.isNumber(n.value)&&n.value>-1){if(i=n.value+n.step,void 0!=n.max&&i>n.max)return;n.value=i}void 0!=i&&(n.el.value=i),!1===e.event.trigger("change",null,n.el)&&(n.el.value=n.value=a)},_reduce:function(){var i,n=this,a=n.value;if(e.isNumber(n.value)&&n.value>0){if(i=n.value-n.step,void 0!=n.min&&i<n.min)return;n.value=i}void 0!=i&&(n.el.value=i),!1===e.event.trigger("change",null,n.el)&&(n.el.value=n.value=a)}}),e(function(){e(n.body).bind(r,a),d&&e(n.body).bind(v,a)}),i.IncreaseReduce=e.IncreaseReduce=s}}(window.Wade,window,document);